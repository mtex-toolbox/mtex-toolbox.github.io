---
title: grain2d.merge

sidebar: function_reference_sidebar
permalink: grain2d.merge.html
folder: function_reference
toc: false
---
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
    -->
<title>grain2d.merge</title>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.source" content="script_grain2d__merge.m">
</head>
<body>
<font size="2"><a href="https://github.com/mtex-toolbox/mtex/blob/develop/EBSDAnalysis/@grain2d/merge.m">
    edit page</a></font>
<div>
<!--introduction-->
<!--/introduction-->
<p>merge grains along special grain boundaries</p>
<p>Whenever two grains share a grain boundary that is in the list <code class="language-plaintext highlighter-rouge">gB</code> both grains are merged and the common grain boundary is removed. All the properties of the unmerged grains are removed in the merged grains, since there is no common convention for a mean. In case of merging allong small angle grain boundaries one can force MTEX to compute a new meanOrientation using the option <code class="language-plaintext highlighter-rouge">calcMeanOrientation</code>.</p>
<h2 id="3">Syntax</h2>
{% highlight matlab %}
[grainsMerged,parentId] = merge(grains,gB)
{% endhighlight %}

{% highlight matlab %}
% compute new meanOrientations for the grains
[grainsMerged,parentId] = merge(grains,gB,'calcMeanOrientation')
{% endhighlight %}

{% highlight matlab %}
[grainsMerged,parentId] = merge(grains,M)
{% endhighlight %}

{% highlight matlab %}
[grainsMerged,parentId] = merge(grains,tpList)
{% endhighlight %}

{% highlight matlab %}
% merge by a list of pairs of grainIds
[grainsMerged,parentId] = merge(grains,gid)
{% endhighlight %}

{% highlight matlab %}
% merge grains with small misorientation angle
[grainsMerged,parentId] = merge(grains,'threshold',delta)
{% endhighlight %}

{% highlight matlab %}
% merge all inclusions with a maximum pixel size
[grainsMerged,parentId] = merge(grains,'inclusions','maxSize',5)
{% endhighlight %}
<h2 id="4">Input</h2>
<p>
   <table cellpadding="4" cellspacing="0" class="funcref" width="100%">
      <tr>
         <td width="100px">
            <tt>grains</tt>
         </td>
         <td>
            <tt><a href="grain2d.grain2d.html">grain2d</a></tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>boundary</tt>
         </td>
         <td>
            <tt><a href="grainBoundary.grainBoundary.html">grainBoundary</a></tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>M</tt>
         </td>
         <td>
            <tt>merge matrix M(i,j)==1 indicates the grains to be merged</tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>tpList</tt>
         </td>
         <td>
            <tt><a href="triplePointList.triplePointList.html">triplePointList</a></tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>gid</tt>
         </td>
         <td>
            <tt>n x 2 list of grainIds</tt>
         </td>
      </tr>
   </table>
</p>
<h2 id="5">Output</h2>
<p>
   <table cellpadding="4" cellspacing="0" class="funcref" width="100%">
      <tr>
         <td width="100px">
            <tt>grainsMerged</tt>
         </td>
         <td>
            <tt><a href="grain2d.grain2d.html">grain2d</a></tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>parentId</tt>
         </td>
         <td>
            <tt>a list of the same size as grains containing the ids of the merged grains</tt>
         </td>
      </tr>
   </table>
</p>
<h2 id="6">Options</h2>
<p>
   <table cellpadding="4" cellspacing="0" class="funcref" width="100%">
      <tr>
         <td width="100px">
            <tt>threshold</tt>
         </td>
         <td>
            <tt>maximum misorientation angle to be merged as similar</tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>maxSize</tt>
         </td>
         <td>
            <tt>maximum number of pixels to be merged as an inclusion</tt>
         </td>
      </tr>
   </table>
</p>
<h2 id="7">Example</h2>
{% highlight matlab %}
mtexdata small
grains = smooth(calcGrains(ebsd,'minPixel',5))
{% endhighlight %}

{% highlight plaintext %}
ebsd = EBSD (y↑→x)
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     0    1197 (32%)  notIndexed                                                 
     1    1952 (52%)  Forsterite  LightSkyBlue       mmm                         
     2    290 (7.8%)   Enstatite  DarkSeaGreen       mmm                         
     3    282 (7.6%)    Diopside     Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad
 Scan unit : um
 X x Y x Z : [33000, 36000] x [4500, 7500] x [0, 0]
 Normal vector: (0,0,1)
 
 
grains = grain2d (y↑→x)
 
 Phase  Grains  Pixels     Mineral  Symmetry  Crystal reference frame
     0      25     840  notIndexed                                   
     1      14    1907  Forsterite       mmm                         
     2       5     226   Enstatite       mmm                         
     3       5     222    Diopside     12/m1       X||a*, Y||b*, Z||c
 
 boundary segments: 1472 (58440 µm)
 inner boundary segments: 0 (0 µm)
 triple points: 47
 
 Properties: meanRotation, GOS
{% endhighlight %}
<p>merge all neighboring Diopside grains</p>
{% highlight matlab %}
gB = grains.boundary('Diopside','Diopside')
[grains_m,parentId] = merge(grains,gB)
{% endhighlight %}

{% highlight plaintext %}
gB = grainBoundary
 
 Segments  length  mineral 1  mineral 2
        4  122 µm   Diopside   Diopside
 
grains_m = grain2d (y↑→x)
 
 Phase  Grains  Pixels     Mineral  Symmetry  Crystal reference frame
     0      25     840  notIndexed                                   
     1      14    1907  Forsterite       mmm                         
     2       5     226   Enstatite       mmm                         
     3       4     222    Diopside     12/m1       X||a*, Y||b*, Z||c
 
 boundary segments: 1468 (58318 µm)
 inner boundary segments: 0 (0 µm)
 triple points: 46
 
 Properties: meanRotation, GOS
 
parentId =
     1
     2
     3
     4
     5
     6
     7
     8
     9
    10
    11
    12
    13
    14
    15
    16
    17
    18
    19
    20
    21
    22
    23
    24
    25
    26
    27
    28
    29
    30
    31
    48
    32
    33
    34
    35
    48
    36
    37
    38
    39
    40
    41
    42
    43
    44
    45
    46
    47
{% endhighlight %}
</div>
</body>
</html>
